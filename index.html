<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="TaxiRechner">

    <link rel="apple-touch-icon" href="/apple-touch-icon.png">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mietwagen-Preisrechner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #eef2ff; /* Helles Blau-Lila */
            padding-top: 250px; /* Platz f√ºr den fixierten Header (H√∂he ca. 110px + Puffer) */
        }
        .card {
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            /* NEU: Zus√§tzlicher Abstand oben f√ºr die wei√üe Karte, damit die √úberschrift nicht √ºberdeckt wird */
            margin-top: 45px;
        }
        .input-style {
            transition: all 0.2s;
            border-color: #e5e7eb;
            background-color: #f9fafb;
        }
        .input-style:focus {
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(165, 180, 252, 0.5);
        }
        /* Sticky Header Style */
        .sticky-header {
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 512px; /* max-w-lg */
            z-index: 100;
            border-bottom-left-radius: 1rem;
            border-bottom-right-radius: 1rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        /* Zus√§tzlicher Style f√ºr die dynamisch eingeblendeten Felder */
        .hidden-transition {
            transition: opacity 0.3s ease-in-out, max-height 0.5s ease-in-out;
            opacity: 0;
            max-height: 0;
            overflow: hidden;
            margin-top: 0;
        }
        .visible-transition {
            opacity: 1;
            max-height: 200px; /* Ausreichend Platz f√ºr die Elemente */
            margin-top: 1rem;
        }
    </style>
</head>
<body class="p-4 flex flex-col items-center min-h-screen">

    <div class="w-full max-w-lg sticky-header bg-indigo-700 p-5 md:p-6">
        <h2 class="text-sm font-semibold text-indigo-300 mb-1 uppercase tracking-wider">Ihr aktueller Fahrpreis:</h2>
        <div class="flex justify-between items-end">
            <span id="totalFare" class="text-5xl font-extrabold text-green-300">8,50 ‚Ç¨</span>
            <span class="text-3xl font-bold text-white">Gesamt</span>
        </div>
    </div><br><br><br>

    <div class="w-full max-w-lg card bg-white rounded-xl p-6 md:p-8">
        <h1 class="text-3xl font-extrabold text-gray-800 mb-2">Preisdetails eingeben</h1>
        <p class="text-gray-500 mb-8 border-b pb-4">Geben Sie Ihre Fahrtparameter ein, um die Gesamtkosten zu berechnen.</p>

        <div class="space-y-6">

            <div>
                <label for="distanceKm" class="block text-sm font-semibold text-gray-700 mb-1">
                    Fahrstrecke (km)
                </label>
                <input type="number" id="distanceKm" min="0" step="0.1"
                        placeholder="Bitte km eingeben"
                        oninput="calculateFare()"
                        class="input-style w-full p-3 border rounded-lg text-lg focus:outline-none"
                        aria-label="Fahrstrecke in Kilometern"
                        autocomplete="off"
                        value="">
            </div>

            <div>
                <label for="waitingMinutes" class="block text-sm font-semibold text-gray-700 mb-1">
                    Stand-/Wartezeit (Minuten)
                </label>
                <input type="number" id="waitingMinutes" min="0" step="1"
                        placeholder="Wartezeit in Minuten eingeben"
                        oninput="calculateFare()"
                        class="input-style w-full p-3 border rounded-lg text-lg focus:outline-none"
                        aria-label="Wartezeit in Minuten"
                        autocomplete="off"
                        value="">
            </div>

            <div>
                <label for="arrivalSurcharge" class="block text-sm font-semibold text-gray-700 mb-1">
                    Anfahrtspauschale
                </label>
                <select id="arrivalSurcharge" onchange="calculateFare()"
                        class="input-style w-full p-3 border rounded-lg text-lg focus:outline-none appearance-none bg-white pr-8"
                        aria-label="Anfahrtskosten ausw√§hlen">
                    <option value="0.00">Anfahrtskosten ausw√§hlen</option>
                    <option value="5.00">5,00 ‚Ç¨</option>
                    <option value="10.00">10,00 ‚Ç¨</option>
                    <option value="15.00">15,00 ‚Ç¨</option>
                    <option value="20.00">20,00 ‚Ç¨</option>
                    <option value="25.00">25,00 ‚Ç¨</option>
                    <option value="30.00">30,00 ‚Ç¨</option>
                    <option value="40.00">40,00 ‚Ç¨</option>
                    <option value="50.00">50,00 ‚Ç¨</option>
                </select>
            </div>


            <div class="space-y-4 pt-2 pb-4 border-t border-b">
                <p class="text-sm font-semibold text-gray-700">Optionale Zuschl√§ge:</p>

                <div class="flex items-center">
                    <input id="isWheelchair" type="checkbox" onchange="calculateFare()"
                            class="h-5 w-5 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"
                            aria-label="Rollstuhlzuschlag aktivieren">
                    <label for="isWheelchair" class="ml-3 text-base font-medium text-gray-700">
                        Rollstuhlzuschlag
                    </label>
                </div>

                <div class="flex items-center">
                    <input id="isNight" type="checkbox" onchange="calculateFare()"
                            class="h-5 w-5 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"
                            aria-label="Nachtzuschlag aktivieren">
                    <label for="isNight" class="ml-3 text-base font-medium text-gray-700">
                        Nachtfahrt (22:00 - 06:00 Uhr)
                    </label>
                </div>

                <div class="flex items-center">
                    <input id="isSmallLuggage" type="checkbox" onchange="calculateFare()"
                            class="h-5 w-5 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"
                            aria-label="Kleiner Gep√§ckzuschlag aktivieren">
                    <label for="isSmallLuggage" class="ml-3 text-base font-medium text-gray-700">
                        Gep√§ck klein (15,00 ‚Ç¨)
                    </label>
                </div>

                <div class="flex items-center">
                    <input id="isLargeLuggage" type="checkbox" onchange="calculateFare()"
                            class="h-5 w-5 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"
                            aria-label="Gro√üer Gep√§ckzuschlag aktivieren">
                    <label for="isLargeLuggage" class="ml-3 text-base font-medium text-gray-700">
                        Gep√§ck gro√ü (30,00 ‚Ç¨)
                    </label>
                </div>
                <div class="flex items-center">
                    <input id="isCarryChair" type="checkbox" onchange="toggleCarryChairOptions(); calculateFare();"
                            class="h-5 w-5 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"
                            aria-label="Tragestuhlzuschlag aktivieren">
                    <label for="isCarryChair" class="ml-3 text-base font-medium text-gray-700">
                        Tragestuhlzuschlag (Spezialtransport)
                    </label>
                </div>

                <div id="carryChairOptions" class="hidden-transition space-y-4 pl-6 border-l-4 border-indigo-300 bg-indigo-50 p-3 rounded-lg">

                    <div>
                        <label for="stairCount" class="block text-sm font-semibold text-gray-700 mb-1">
                            Anzahl Treppen (jeweils 12,00 ‚Ç¨)
                        </label>
                        <input type="number" id="stairCount" min="0" step="1"
                                placeholder="Anzahl der Treppen eingeben"
                                oninput="calculateFare()"
                                class="input-style w-full p-3 border rounded-lg text-lg focus:outline-none"
                                autocomplete="off"
                                value="">
                    </div>

                    <div class="flex items-center">
                        <input id="isCompanyWheelchair" type="checkbox" onchange="calculateFare()"
                                class="h-5 w-5 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"
                                aria-label="Firmenrollstuhlzuschlag aktivieren">
                        <label for="isCompanyWheelchair" class="ml-3 text-base font-medium text-gray-700">
                            Firmenrollstuhl (12,00 ‚Ç¨)
                        </label>
                    </div>

                    <div class="flex items-center">
                        <input id="isStairClimber" type="checkbox" onchange="calculateFare()"
                                class="h-5 w-5 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"
                                aria-label="Treppenraupezuschlag aktivieren">
                        <label for="isStairClimber" class="ml-3 text-base font-medium text-gray-700">
                            Treppenraupe (30,00 ‚Ç¨)
                        </label>
                    </div>
                </div>

            </div>

             <button onclick="resetInputs()"
                    class="w-full bg-gray-200 text-gray-700 p-3 rounded-lg font-semibold hover:bg-gray-300 transition duration-150 ease-in-out">
                Eingaben l√∂schen üóëÔ∏è
            </button>

            <button onclick="shareViaWhatsapp()"
                    class="w-full bg-green-500 text-white p-3 rounded-lg font-semibold hover:bg-green-600 transition duration-150 ease-in-out">
                Per WhatsApp teilen (Name wird abgefragt) üì≤
            </button>
        </div>

        <div class="mt-8 border-t pt-6 bg-gray-50 p-4 rounded-lg">
            <h3 class="text-xl font-extrabold text-gray-800 mb-4 border-b pb-2">Kosten-Aufschl√ºsselung</h3>
            <div class="space-y-3 text-base">
                <div class="flex justify-between text-gray-600">
                    <span>Grundgeb√ºhr (8,50 ‚Ç¨):</span>
                    <span id="detailBaseFare" class="font-medium text-gray-800">8,50 ‚Ç¨</span>
                </div>
                <div class="flex justify-between text-gray-600">
                    <span>Distanzkosten (2,50 ‚Ç¨/km):</span>
                    <span id="detailDistanceCost" class="font-medium text-gray-800">0,00 ‚Ç¨</span>
                </div>
                <div class="flex justify-between text-gray-600">
                    <span>Wartezeitkosten (0,75 ‚Ç¨/Min):</span>
                    <span id="detailWaitingCost" class="font-medium text-gray-800">0,00 ‚Ç¨</span>
                </div>
                <div class="flex justify-between text-gray-600 border-t pt-3 mt-3 border-dashed">
                    <span class="text-sm">Anfahrtspauschale:</span>
                    <span id="detailArrivalSurcharge" class="font-medium text-red-500">0,00 ‚Ç¨</span>
                </div>
                <div class="flex justify-between text-gray-600">
                    <span class="text-sm">Nachtzuschlag (1,50 ‚Ç¨):</span>
                    <span id="detailNightSurcharge" class="font-medium text-red-500">0,00 ‚Ç¨</span>
                </div>
                 <div class="flex justify-between text-gray-600">
                    <span class="text-sm">Rollstuhlzuschlag (10,00 ‚Ç¨):</span>
                    <span id="detailWheelchairSurcharge" class="font-medium text-red-500">0,00 ‚Ç¨</span>
                </div>
                <div class="flex justify-between text-gray-600">
                    <span class="text-sm">Gep√§ck klein (15,00 ‚Ç¨):</span>
                    <span id="detailSmallLuggage" class="font-medium text-red-500">0,00 ‚Ç¨</span>
                </div>
                <div class="flex justify-between text-gray-600">
                    <span class="text-sm">Gep√§ck gro√ü (30,00 ‚Ç¨):</span>
                    <span id="detailLargeLuggage" class="font-medium text-red-500">0,00 ‚Ç¨</span>
                </div>
                <div class="flex justify-between text-gray-600">
                    <span class="text-sm">Treppenkosten (<span id="stairCountDisplay">0</span> x 12,00 ‚Ç¨):</span>
                    <span id="detailStairCost" class="font-medium text-red-500">0,00 ‚Ç¨</span>
                </div>
                <div class="flex justify-between text-gray-600">
                    <span class="text-sm">Firmenrollstuhl (12,00 ‚Ç¨):</span>
                    <span id="detailCompanyWheelchair" class="font-medium text-red-500">0,00 ‚Ç¨</span>
                </div>
                <div class="flex justify-between text-gray-600">
                    <span class="text-sm">Treppenraupe (30,00 ‚Ç¨):</span>
                    <span id="detailStairClimber" class="font-medium text-red-500">0,00 ‚Ç¨</span>
                </div>

                <div class="flex justify-between font-extrabold text-2xl text-indigo-700 pt-4 border-t mt-4">
                    <span>SUMME:</span>
                    <span id="detailTotalSum">8,50 ‚Ç¨</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tarife (ERWEITERT)
        const TARIFFS = {
            BASE_FARE: 8.50,
            DISTANCE_RATE_PER_KM: 2.50,
            NIGHT_SURCHARGE: 1.50,
            WHEELCHAIR_SURCHARGE: 10.00,
            WAITING_RATE_PER_MINUTE: 0.75,
            STAIR_RATE_PER_STEP: 12.00,
            COMPANY_WHEELCHAIR_SURCHARGE: 12.00,
            STAIR_CLIMBER_SURCHARGE: 30.00,
            // NEU: Gep√§cktarife
            SMALL_LUGGAGE_SURCHARGE: 15.00,
            LARGE_LUGGAGE_SURCHARGE: 30.00
        };

        // Hilfsfunktion zur Formatierung als W√§hrung (Deutsch)
        function formatCurrency(amount) {
            return amount.toLocaleString('de-DE', { style: 'currency', currency: 'EUR' });
        }

        // Berechnet die Distanzkosten (Unver√§ndert)
        function calculateDistanceCost(distanceKm) {
            return distanceKm * TARIFFS.DISTANCE_RATE_PER_KM;
        }

        /**
         * Schaltet die Tragestuhl-Optionen ein oder aus.
         */
        function toggleCarryChairOptions() {
            const isCarryChair = document.getElementById('isCarryChair').checked;
            const optionsDiv = document.getElementById('carryChairOptions');
            const stairCountInput = document.getElementById('stairCount');
            const companyWheelchairCheckbox = document.getElementById('isCompanyWheelchair');
            const stairClimberCheckbox = document.getElementById('isStairClimber');

            if (isCarryChair) {
                optionsDiv.classList.remove('hidden-transition');
                optionsDiv.classList.add('visible-transition');
            } else {
                optionsDiv.classList.remove('visible-transition');
                optionsDiv.classList.add('hidden-transition');

                // Setze die Werte der eingeblendeten Felder zur√ºck, wenn Tragestuhl deaktiviert wird
                stairCountInput.value = ''; // WICHTIG: Leeren, um Platzhalter sichtbar zu machen
                companyWheelchairCheckbox.checked = false;
                stairClimberCheckbox.checked = false;
            }
        }


        /**
         * Hauptfunktion zur Berechnung des Fahrpreises.
         */
        function calculateFare() {
            const distanceInput = document.getElementById('distanceKm');
            const waitingInput = document.getElementById('waitingMinutes');
            const nightCheckbox = document.getElementById('isNight');
            const wheelchairCheckbox = document.getElementById('isWheelchair');
            const arrivalSelect = document.getElementById('arrivalSurcharge');

            // NEU: Gep√§ck-Elemente
            const smallLuggageCheckbox = document.getElementById('isSmallLuggage');
            const largeLuggageCheckbox = document.getElementById('isLargeLuggage');

            // Tragestuhl-Elemente
            const carryChairCheckbox = document.getElementById('isCarryChair');
            const stairCountInput = document.getElementById('stairCount');
            const companyWheelchairCheckbox = document.getElementById('isCompanyWheelchair');
            const stairClimberCheckbox = document.getElementById('isStairClimber');

            const distanceKm = Math.max(0, parseFloat(distanceInput.value) || 0);
            const waitingMinutes = Math.max(0, parseInt(waitingInput.value, 10) || 0);

            const isNight = nightCheckbox.checked;
            const isWheelchair = wheelchairCheckbox.checked;
            const arrivalSurchargeCost = parseFloat(arrivalSelect.value) || 0;

            // NEU: Gep√§ck-Status
            const isSmallLuggage = smallLuggageCheckbox.checked;
            const isLargeLuggage = largeLuggageCheckbox.checked;

            // Tragestuhl-Berechnung
            const isCarryChair = carryChairCheckbox.checked;
            // Wenn das Feld leer ist, ist der Wert 0
            const stairCount = isCarryChair ? Math.max(0, parseInt(stairCountInput.value, 10) || 0) : 0;
            const isCompanyWheelchair = isCarryChair && companyWheelchairCheckbox.checked;
            const isStairClimber = isCarryChair && stairClimberCheckbox.checked;

            let totalFare = 0;
            let distanceCost = 0;
            let waitingCost = 0;
            let nightSurcharge = 0;
            let wheelchairSurcharge = 0;
            // NEU: Gep√§ck-Kosten
            let smallLuggageCost = 0;
            let largeLuggageCost = 0;
            let stairCost = 0;
            let companyWheelchairCost = 0;
            let stairClimberCost = 0;
            let baseFare = TARIFFS.BASE_FARE;

            // 1. Distanzkosten
            distanceCost = calculateDistanceCost(distanceKm);

            // 2. Wartezeitkosten
            waitingCost = waitingMinutes * TARIFFS.WAITING_RATE_PER_MINUTE;

            // 3. Zuschl√§ge (Standard)
            if (isNight) {
                nightSurcharge = TARIFFS.NIGHT_SURCHARGE;
            }
            if (isWheelchair) {
                wheelchairSurcharge = TARIFFS.WHEELCHAIR_SURCHARGE;
            }
            // NEU: Gep√§ck-Kosten berechnen
            if (isSmallLuggage) {
                smallLuggageCost = TARIFFS.SMALL_LUGGAGE_SURCHARGE;
            }
            if (isLargeLuggage) {
                largeLuggageCost = TARIFFS.LARGE_LUGGAGE_SURCHARGE;
            }

            // 4. Zuschl√§ge (Tragestuhl)
            if (isCarryChair) {
                stairCost = stairCount * TARIFFS.STAIR_RATE_PER_STEP;
                if (isCompanyWheelchair) {
                    companyWheelchairCost = TARIFFS.COMPANY_WHEELCHAIR_SURCHARGE;
                }
                if (isStairClimber) {
                    stairClimberCost = TARIFFS.STAIR_CLIMBER_SURCHARGE;
                }
            }


            // 5. Gesamtfahrpreis
            totalFare = baseFare + distanceCost + waitingCost + arrivalSurchargeCost + nightSurcharge + wheelchairSurcharge + smallLuggageCost + largeLuggageCost + stairCost + companyWheelchairCost + stairClimberCost;

            // Rundet auf zwei Dezimalstellen
            totalFare = Math.round(totalFare * 100) / 100;

            // Ergebnis im UI anzeigen
            document.getElementById('totalFare').textContent = formatCurrency(totalFare);

            // Aufschl√ºsselung aktualisieren
            document.getElementById('detailBaseFare').textContent = formatCurrency(baseFare);
            document.getElementById('detailDistanceCost').textContent = formatCurrency(distanceCost);
            document.getElementById('detailWaitingCost').textContent = formatCurrency(waitingCost);
            document.getElementById('detailArrivalSurcharge').textContent = formatCurrency(arrivalSurchargeCost);
            document.getElementById('detailNightSurcharge').textContent = formatCurrency(nightSurcharge);
            document.getElementById('detailWheelchairSurcharge').textContent = formatCurrency(wheelchairSurcharge);

            // NEU: Gep√§ck-Aufschl√ºsselung
            document.getElementById('detailSmallLuggage').textContent = formatCurrency(smallLuggageCost);
            document.getElementById('detailLargeLuggage').textContent = formatCurrency(largeLuggageCost);

            // Tragestuhl-Aufschl√ºsselung
            document.getElementById('stairCountDisplay').textContent = stairCount;
            document.getElementById('detailStairCost').textContent = formatCurrency(stairCost);
            document.getElementById('detailCompanyWheelchair').textContent = formatCurrency(companyWheelchairCost);
            document.getElementById('detailStairClimber').textContent = formatCurrency(stairClimberCost);

            document.getElementById('detailTotalSum').textContent = formatCurrency(totalFare);
        }

        /**
         * Setzt alle Eingabefelder auf ihren Standardwert (leer oder false) zur√ºck und berechnet neu.
         */
        function resetInputs() {
            document.getElementById('distanceKm').value = '';
            document.getElementById('waitingMinutes').value = '';
            document.getElementById('isNight').checked = false;
            document.getElementById('isWheelchair').checked = false;
            document.getElementById('arrivalSurcharge').value = '0.00';

            // NEU: Gep√§ck-Felder zur√ºcksetzen
            document.getElementById('isSmallLuggage').checked = false;
            document.getElementById('isLargeLuggage').checked = false;

            // Tragestuhl-Felder zur√ºcksetzen
            document.getElementById('isCarryChair').checked = false;
            // Die dynamischen Optionen √ºber die Toggle-Funktion zur√ºcksetzen
            toggleCarryChairOptions();

            calculateFare();
        }

        /**
         * Teilt den berechneten Fahrpreis per WhatsApp und fragt den Namen √ºber ein Prompt-Fenster ab.
         */
        function shareViaWhatsapp() {
            const totalFareText = document.getElementById('totalFare').textContent;
            const passengerName = prompt("Bitte geben Sie den Namen des Fahrgastes ein:");

            if (!passengerName) {
                console.error("WhatsApp-Vorgang abgebrochen, da kein Name eingegeben wurde.");
                return;
            }

            // Eingabewerte f√ºr Details abrufen
            const distanceKm = parseFloat(document.getElementById('distanceKm').value) || 0;
            const waitingMinutes = parseInt(document.getElementById('waitingMinutes').value, 10) || 0;
            const arrivalSurchargeCost = parseFloat(document.getElementById('arrivalSurcharge').value) || 0;
            const isNight = document.getElementById('isNight').checked;
            const isWheelchair = document.getElementById('isWheelchair').checked;
            // NEU: Gep√§ck-Werte
            const isSmallLuggage = document.getElementById('isSmallLuggage').checked;
            const isLargeLuggage = document.getElementById('isLargeLuggage').checked;

            // Tragestuhl-Werte
            const isCarryChair = document.getElementById('isCarryChair').checked;
            // Wenn das Feld leer ist, ist der Wert 0
            const stairCount = isCarryChair ? parseInt(document.getElementById('stairCount').value, 10) || 0 : 0;
            const isCompanyWheelchair = isCarryChair && document.getElementById('isCompanyWheelchair').checked;
            const isStairClimber = isCarryChair && document.getElementById('isStairClimber').checked;

            // Berechnung f√ºr WhatsApp-Nachricht (muss dieselben Werte verwenden wie calculateFare)
            const baseFare = TARIFFS.BASE_FARE;
            const distanceCost = calculateDistanceCost(distanceKm);
            const waitingCost = waitingMinutes * TARIFFS.WAITING_RATE_PER_MINUTE;
            let nightSurcharge = isNight ? TARIFFS.NIGHT_SURCHARGE : 0;
            let wheelchairSurcharge = isWheelchair ? TARIFFS.WHEELCHAIR_SURCHARGE : 0;
            // NEU: Gep√§ck-Kosten
            let smallLuggageCost = isSmallLuggage ? TARIFFS.SMALL_LUGGAGE_SURCHARGE : 0;
            let largeLuggageCost = isLargeLuggage ? TARIFFS.LARGE_LUGGAGE_SURCHARGE : 0;
            let stairCost = isCarryChair ? stairCount * TARIFFS.STAIR_RATE_PER_STEP : 0;
            let companyWheelchairCost = isCompanyWheelchair ? TARIFFS.COMPANY_WHEELCHAIR_SURCHARGE : 0;
            let stairClimberCost = isStairClimber ? TARIFFS.STAIR_CLIMBER_SURCHARGE : 0;

            // Detaillierte Nachricht konstruieren
            let message = `Fahrt von ${passengerName} kostet ${totalFareText}.\n\n`;
            message += `DETAILS:\n`;
            message += `Grundgeb√ºhr: ${formatCurrency(baseFare)}\n`;

            if (distanceKm > 0) {
                message += `Distanzkosten (${distanceKm} km): ${formatCurrency(distanceCost)}\n`;
            }
            if (waitingMinutes > 0) {
                message += `Wartezeit (${waitingMinutes} Min): ${formatCurrency(waitingCost)}\n`;
            }
            if (arrivalSurchargeCost > 0) {
                 message += `Anfahrtspauschale: ${formatCurrency(arrivalSurchargeCost)}\n`;
            }
            if (nightSurcharge > 0) {
                message += `Nachtzuschlag: ${formatCurrency(nightSurcharge)}\n`;
            }
            if (wheelchairSurcharge > 0) {
                message += `Rollstuhlzuschlag: ${formatCurrency(wheelchairSurcharge)}\n`;
            }

            // NEU: Gep√§ck-Details
            if (smallLuggageCost > 0) {
                message += `Gep√§ck klein: ${formatCurrency(smallLuggageCost)}\n`;
            }
            if (largeLuggageCost > 0) {
                message += `Gep√§ck gro√ü: ${formatCurrency(largeLuggageCost)}\n`;
            }

            // Tragestuhl-Details
            if (isCarryChair) {
                message += `--- Tragestuhl-Zuschl√§ge ---\n`;
                if (stairCount > 0) {
                    message += `Treppenkosten (${stairCount} St.): ${formatCurrency(stairCost)}\n`;
                }
                if (companyWheelchairCost > 0) {
                    message += `Firmenrollstuhl: ${formatCurrency(companyWheelchairCost)}\n`;
                }
                if (stairClimberCost > 0) {
                    message += `Treppenraupe: ${formatCurrency(stairClimberCost)}\n`;
                }
            }

            // Endsumme hinzuf√ºgen
            message += `\nGESAMTSUMME: ${totalFareText}`;

            // Nachricht URL-kodieren
            const encodedMessage = encodeURIComponent(message);

            // WhatsApp Link erstellen und √∂ffnen
            const whatsappUrl = `https://wa.me/?text=${encodedMessage}`;
            window.open(whatsappUrl, '_blank');
        }


        // Berechnen Sie den Preis beim ersten Laden der Seite, um den Standardwert anzuzeigen
        window.onload = function() {
            // Initialen Zustand der Tragestuhl-Optionen setzen
            toggleCarryChairOptions();
            // Initialen Preis berechnen
            calculateFare();
        }

    </script>
</body>
</html>
